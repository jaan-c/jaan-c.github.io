<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=/images/logo.png><link rel=stylesheet href=/css/simple.min.css><title>SSDs Go Brrr</title></head><body><header><div class=navigation><h3>Jaan</h3><nav><a href=/>Home</a>
<a href=/blog/>Blog</a>
<a href=/about/>About</a></nav></div><div class=content-header><h1>SSDs Go Brrr</h1><h5>Feb 5 2021</h5><h4>Or my experience upgrading to an SSD!</h4></div></header><main><p>Most of my experience with computers involve passed down laptops or unused computers at home. I&rsquo;ve always assumed that they&rsquo;re just painfully slow because of the CPU and stuck with it. Since I only code on the desktop and watch some videos from time to time, it never bothered me.</p><p>Up until I got into Android development (with Kotlin) again, after getting tired of Flutter&rsquo;s limitations, that&rsquo;s when I notice how much of a bottleneck the hard drive speed is. Booting up takes 3 to 5 minutes, starting Android Studio would take a very long time I&rsquo;d find myself procrastinating, and launching the Android emulator just freezes the entire desktop unusable for a good 8 minutes.</p><p>So with the not so much money I have left I started looking into SSDs. As most people who are new to SSDs and started researching about it would know, some SSDs have a DRAM cache and some don&rsquo;t, but they&rsquo;re cheaper. SSDs work a lot differently than hard drives, since memory cells have a limited amount of times it can be written to, it does something called wear-leveling, where it will distribute writes across memory cells to try to balance out the &ldquo;wear&rdquo; over time. Because of this data has to be moved around quite often and the data location your OS sees doesn&rsquo;t always map out to the real physical location, DRAM basically acts as a store for that mapping of virtual to physical location, it&rsquo;s a lot faster than where your data resides and is probably used for a lot of other optimizations too.</p><p>With my limited budget I could only get an SSD without a DRAM cache, so I don&rsquo;t know why I spent that much effort to trying to explain why it&rsquo;s so badass. So I started contemplating whether I should get one, worried it&rsquo;ll offer no noticeable difference compared to my current hard drive. But I did get one anyway.</p><p>So here are some <em>important stuffâ„¢</em> I discovered. Chances are if you are using an old computer, the SATA mode in your BIOS settings is set to <em>IDE</em> <del>when it should be set to WUMBO!</del>, this significantly impacts SSD speed and should be set to <em>AHCI</em>, but mind you this borks some Windows installation, in my case, Windows 10 just showed a blue screen of death, and after a reboot, it magically fixed itself. To compensate for the write speed, I mount my <code>btrfs</code> filesystem with level 9 compression.</p><p>So there we go, I got the Crucial BX500 SSD. The read speed is well above 500 MB/s, and initial sequential writes starts at around 250 MB/s and gradually dips to 80 MB/s if you write more than 5 GB at it at a time. It&rsquo;s good enough for my use case, which is heavy on the read side. Now my computer boots up in less than 10 seconds, Android Studio launches fast, and amazingly, the Android emulator works a lot smoother now, no more random janks and frequent freezes. So if you&rsquo;re in the market for SSDs and don&rsquo;t have much budget to spare, DRAM-less SSDs aren&rsquo;t as bad as most people make it out to be, and is already a massive leap from hard drives. Turns out a decade old i5-2400 CPU is still good enough for modern programs!</p><hr><p>Some other helpful things I discovered along the way. If you find yourself needing just a bit more RAM, consider enabling <code>zram</code>. <code>zram</code> works like swap, but instead writing data to disk, it&rsquo;s written to the RAM, and you get the benefits of compression that swap has.</p><p>In Ubuntu you can do this by installing <code>zram-config</code> with <code>apt</code>, which will allocate half of your RAM to be used by <code>zram</code>. Essentially half of your RAM will be compressed, giving you a slightly bit more memory to work with, which helps a lot with the chonky Android Studio!</p><p>You can have <code>zram</code> use <code>zstd</code> as the compression algorithm for better compression ratio without any impact on CPU performance by editing <code>/usr/bin/init-zram-swapping</code>:</p><pre><code>for i in $(seq ${NRDEVICES}); do
  DEVNUMBER=$((i - 1))
  echo lz4 &gt; /sys/block/zram${DEVNUMBER}/comp_algorithm    # Add this bit!
  echo $mem &gt; /sys/block/zram${DEVNUMBER}/disksize
  mkswap /dev/zram${DEVNUMBER}
  swapon -p 5 /dev/zram${DEVNUMBER}
done
</code></pre><p>Now, you&rsquo;re probably thinking, if <code>zram</code> works like swap, why don&rsquo;t I just set <code>vm.swappiness</code> to 100 and have even more RAM! That&rsquo;s a bad idea, the moment you start copying a large amount of files, all your CPU cores will kick up to 100%!</p></main><footer><h5>A very Jaan blog.</h5><h5><a href=https://github.com/jaan-c>github.com/jaan-c</a></h5></footer></body></html>